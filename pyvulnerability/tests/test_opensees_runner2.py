# -*- coding: utf-8 -*-
"""
@author: Salvatore Iacoletti
"""

import os
import time
from pyvulnerability.record import Record
from pyvulnerability.opensees_runner import OpenseesRunner


if __name__ == "__main__":
    
    base = r"C:\Users\Salvatore\Dropbox\SalvIac\pyvulnerability\ground_motion_databases"

    # nga west2 RSN1523_CHICHI_TCU094-N.AT2 RSN4209_NIIGATA_NIG019NS.AT2
    path = os.path.join(base, "NGAWest2", "time_histories", "RSN1523_CHICHI_TCU094-N.AT2")
    rec = Record.load_ngawest2_record(path, allinfo=False)
    # rec.plot_inputs()
    # rec.plot_acc_vel_disp(unit="g")

    # SRC_LDUAL-DUH_H1 /S_LFM-DUH_H35 /CR_LDUAL-DUH_H1 # SRC_LDUAL-DUH_H1
    opr = OpenseesRunner.from_oq("CR_LFINF-DUM_H2")
    # opr.DEGRADATION = False
    t = time.time()
    res = opr.run(rec.get_time_gmr(unit="m/s2", resting_time=0))
    print(time.time()-t)
    opr.plot_acc_disp()
    opr.plot_force_disp()
    
    print(opr.get_max_disp(), opr.calculate_hyst_energy())
    
