# -*- coding: utf-8 -*-
"""
@author: Salvatore Iacoletti
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import openseespy.opensees as ops
from pysequentialvulnerability.base_sdof import (geometry,
                                                 material_martins_silva,
                                                 pushover_analysis)


if __name__ == '__main__':

    # base = r"C:\Users\Salvatore\Documents\GitHub/"
    base = r"C:\Users\Salvatore\Dropbox\SalvIac/"
    filepath = base+r"global_fragility_vulnerability\capacity/CR_LDUAL-DUH_H1.csv"

    ops.wipe()
    capacity_curve = pd.read_csv(filepath).to_numpy()
    material_martins_silva(capacity_curve)
    geometry()
    
    outputs = pushover_analysis(capacity_curve[-1,0]*1.1, capacity_curve[-1,0]/100)

    fig, ax = plt.subplots(1,1)
    ax.plot(capacity_curve[:,0], capacity_curve[:,1]*9.81, marker="o")
    ax.plot(outputs["disp"], outputs["force"], marker="o")
    ax.set_xlabel("Displacement [m]")
    ax.set_ylabel("Acceleration [m/s2]") # technically base shear per unit mass
    plt.show()

